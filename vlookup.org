# Created 2020-05-08 Fri 13:58
#+TITLE:
#+AUTHOR: spqr
* vlookup函数
** 必备函数简介
*** Vlookup函数
- 作用: 查询指定区域中符合条件的值
- 语法: =Vlookup(查找值,数据范围,返回值的列数,匹配模式)
- 目的: 查询销售员的销量和
- 方法:在目标单元格中输入公式: =VLOOKUP(K3,$B$3:$H$10,7,0)
*** RANDBETWEEN函数
- 作用: 随机生成条件范围内的整数
- 语法: =RANDBETWEEN(最小数,最大数)
- 目的:在单元格随机生成1~1000的整数
- 方法:在目标单元格中输入公式: =RANDBETWEEN(1,1000),使用F9刷新数据
*** RANK函数
- 作用:返回数值在所在数列范围内的大小排名
- 语法: =RANK(数值,引用,[排位方式])
- 目的:在单元格进行数值大小排名
- 方法:在目标单元格中输入公式:  =RANK(C36,$C$36:$C$43,0)
- 单元格内下拉菜单筛选
- 工具栏——数据——数据有效性设置（或是“数据验证”——”允许“——序列）,然后进行相应设置
** 制作过程
*** 完善表格,添加辅助列并生成随机值
- 方法:在目标单元格中输入公式:=RANDBETWEEN(1,1000)
*** 基本用法
- 方法:在目标单元格中输入公式: =VLOOKUP(K3,$B$3:$H$10,7,0)
- 注:列序数7为前面"所选列范围"的排序,如上B到H,B为列序数1,H为列序数7
*** 多条件查询
- 方法:
  - 在目标单元格中输入公式: =IFERROR(VLOOKUP(H14&I14,IF({1,0},$B$14:$B$21&$E$14:$E$21,$D$14:$D$21),2,0),"无销量")
  - Ctrl+Shift+Enter填充
*** 多列查询
- 方法:在目标单元格中输入公式:  =VLOOKUP($H25,$B$25:$E$32,COLUMN(B25),0)
*** 两季度销量排名升降名次
- 例如：第二季度销量存在sheet1表,第一季度销量存在sheet2表,假设销售员排序不同
- 现把sheet1表中D列作为存放销售员本季度销量排名
  - 方法:在目标单元格中输入公式:  =RANK(C36,$C$36:$C$43,0)
- 现把sheet1表中E列作为存放销售员销量上升或下降的名次
  - 方法:在目标单元格中输入公式:  =RANK(VLOOKUP(B36,Sheet2!B$3:C$10,2,0),Sheet2!C$3:C$10)-RANK(C36,C$36:C$43)
*** 两季度销售员排序一致
- 方法:在目标单元格中输入公式:  =IFERROR(VLOOKUP($B47,$B$57:$C$61,COLUMN(A47),),"")
- 公式说明：IFERROR函数用来屏蔽错误值
*** 模糊查找
- 方法:在目标单元格中输入公式:  =VLOOKUP("*"&F65&"*",$B$65:$C$72,2,0)
*** 逆向查找
- 方法:在目标单元格中输入公式:  =VLOOKUP(F76,IF({1,0},$C$76:$C$83,$B$76:$B$83),2,)
- 公式说明: 本公式只做了解，遇到逆向查找，建议使用Index+Match函数
  - 方法:在目标单元格中输入公式:  =INDEX($B$75:$B$83,MATCH(F78,$C$75:$C$83,0))
*** 带特殊符合的字符查找
- 方法:在目标单元格中输入公式:  =VLOOKUP(SUBSTITUTE(F87,"*","~*"),$B$87:$C$90,2,0)
- 公式说明:由于~ * ？在公式中有通配符用法，遇到被查找的字符串中含有这3个字符就用Substitute替换为~~、~*和~？
** [[https://kdocs.cn/l/s96h5WMDx][范例参考]]
