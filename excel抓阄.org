# Created 2020-05-08 Fri 18:12
#+TITLE:
#+AUTHOR: spqr
* excel抓阄
** 必备函数简介
*** Index函数
- 作用:返回指定区域中,行列交叉处的值或引用
- 语法:=Index(单元格区域,行,[列])当“列”省略时,默认为第一列
- 目的:返回B2:C9范围内第4行第1列的值
- 方法:在目标单元格中输入公式:=INDEX(B2:C9,3,1)
*** Match函数
- 作用:返回指定值在相对范围中的位置
- 语法:=Match(定位的值,定位的范围,定位模式)定位模式有:-1、0、1三种,分别为:
  - -1:查找大于或等于“定位的值”的最小值
  - 0:精准定位
  - 1:查找小于或等于“定位的值”的最大值
- 目的:返回指定人员的相对位置
- 方法:在目标单元格中输入公式:=MATCH(E2,B2:B9,0)
*** Small函数
- 作用:返回数组中第K个最小值
- 语法:=Small(数组范围,K）
- 目的:返回指定范围内的最小值
- 方法:在目标单元格中输入公式:=SMALL(C2:C9,E2)
*** Large函数
- 作用:返回数组中第K个最大值
- 语法:=Large(数组范围,K)
- 目的:返回第K个最大值
- 方法:在目标单元格汇总输入公式:=LARGE(C2:C9,E2)
*** Rand函数
- 作用:返回大于等于0且小于1的随机数
- 语法:=Rand()
- 目的:随机生成大于等于0且小于1的随机数
- 方法:在目标单元格中输入公式:=RAND(),使用F9刷新数据
** 制作过程
- 完善表格,添加辅助列并生成随机值
  - 方法:在目标单元格中输入公式:=RAND()
- “抓阄”或随机产生相关人员
  - 方法:在目标单元格中输入公式:=INDEX(B:B,MATCH(SMALL(C:C,E2),C:C,0))
** 解读
- 利用Small函数获取随机生成列中的最小值,然后用Match函数对其进行定位,最有用Index函数返回对应位置上的“姓名”
- 除了用Small函数获取随机生成列中的最小值外,还可以用Large函数获取最大值
** [[https://kdocs.cn/l/sMENc73Xa][范例参考]]
